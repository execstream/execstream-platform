# ğŸš€ ExecStream Backend API

This README provides comprehensive documentation for the Executive Stream backend API, including all available routes, request/response formats, role-based access control, and data models related to content publishing, contributor management, tag handling, and newsletter operations.

---

âš ï¸**IMPORTANT UPDATE:**âš ï¸

- Any route that may involve image upload will take all inputs as form-data/multipart format

- ANY form of base64 upload in any route will `NOT` work.

- Whereas, inputs that only handle text data still continue to work on application/json format

- May need to stringify some fields(like arrays)

- Don't give `slug` as key in any request body, It will be auto generated by title.

---

`NO base64` will be accepted.

The creation/updation of any route involving image has to be from `form-data` key-value pairs (even if ou don't attach any image for that request)

## ğŸ’  Local Setup

Follow these steps to run the ExecStream backend locally:

### 1. Clone the repository

```bash
git clone https://github.com/execstream/execstream-platform.git
cd execstream-platform/server
```

### 2. Install dependencies

```bash
npm install
```

### 3. Create a `.env` file

Copy the .env.example file and rename it to .env. Then, fill in the required values.

```env
cp .env.example .env
```

Update the variables in .env with your local configuration (e.g., database URI, API keys).

### 4. Start the development server

```bash
npm run dev
```

Server will be running on [http://localhost:5000](http://localhost:5000) by default.

## ğŸš Base API Routes

| Path                   | Description                                |
| ---------------------- | ------------------------------------------ |
| `/api/v1/auth`         | Authentication (login, register)           |
| `/api/v1/content`      | Content management (CRUD, publish)         |
| `/api/v1/newsletter`   | Newsletter subscriptions & actions         |
| `/api/v1/tags`         | Tag management (themes, industries, roles) |
| `/api/v1/contributors` | Contributor profiles & details             |
| `/api/v1/series`       | Series management                          |
| `/api/v1/web-configs`  | Home Page static files config              |

---

## ğŸš€ Quick Reference

### Public Endpoints (No Auth Required)

- POST /api/v1/auth/login
- POST /api/v1/auth/send-otp
- POST /api/v1/auth/forgot-password
- POST /api/v1/auth/reset-password/:token
- GET /api/v1/content/all (optional auth)
- GET /api/v1/content/slug/:slug
- GET /api/v1/content/flags/all
- POST /api/v1/newsletter/subscribe
- GET /api/v1/tags/themes/all
- GET /api/v1/tags/sub-themes/all
- GET /api/v1/tags/industries/all
- GET /api/v1/tags/roles/all
- GET /api/v1/series/all
- GET /api/v1/series/slug/:slug
- GET /api/v1/web-configs/event-banners/all
- GET /api/v1/web-configs/experts/all
- GET /api/v1/web-configs/partners/all

### Authentication Required

- POST /api/v1/auth/logout
- GET /api/v1/auth/me
- PUT /api/v1/auth/me/update
- PUT /api/v1/auth/change-password
- GET /api/v1/auth/check

### Role-Based Endpoints (superAdmin/editor)

- PUT /api/v1/auth/admins/update-role/:id
- GET /api/v1/auth/admins/all
- GET /api/v1/content/get/:id
- POST /api/v1/content/create
- PATCH /api/v1/content/update/:id
- DELETE /api/v1/content/delete/:id
- PATCH /api/v1/content/publish/:id
- PATCH /api/v1/content/:id/toggle/:flag
- POST /api/v1/content/add/:contentId/contributors
- PATCH /api/v1/content/update/:contentId/contributors/:contributorSubId
- DELETE /api/v1/content/delete/:contentId/contributors/:contributorSubId
- GET /api/v1/tags/themes/usage/:id
- GET /api/v1/tags/sub-themes/usage/:id
- GET /api/v1/tags/industries/usage/:id
- GET /api/v1/tags/roles/usage/:id
- POST /api/v1/tags/themes/new
- PUT /api/v1/tags/themes/update/:id
- DELETE /api/v1/tags/themes/delete/:id
- POST /api/v1/tags/sub-themes/new
- PUT /api/v1/tags/sub-themes/update/:id
- DELETE /api/v1/tags/sub-themes/delete/:id
- POST /api/v1/tags/industries/new
- PUT /api/v1/tags/industries/update/:id
- DELETE /api/v1/tags/industries/delete/:id
- POST /api/v1/tags/roles/new
- PUT /api/v1/tags/roles/update/:id
- DELETE /api/v1/tags/roles/delete/:id
- GET /api/v1/contributors/all
- GET /api/v1/contributors/:id
- POST /api/v1/contributors/new
- PATCH /api/v1/contributors/update/:id
- DELETE /api/v1/contributors/delete/:id
- POST /api/v1/series/create
- PATCH /api/v1/series/update/:id
- DELETE /api/v1/series/delete/:id
- GET /api/v1/series/get/:id
- GET /api/v1/series/usage/:id
- POST /api/v1/web-configs/event-banners/new
- GET /api/v1/web-configs/event-banners/all-admin
- PATCH /api/v1/web-configs/event-banners/toggle-active/:id
- DELETE /api/v1/web-configs/event-banners/delete/:id
- POST /api/v1/web-configs/experts/new
- PATCH /api/v1/web-configs/experts/update/:id
- GET /api/v1/web-configs/experts/all-admin
- PATCH /api/v1/web-configs/experts/toggle-active/:id
- DELETE /api/v1/web-configs/experts/delete/:id
- POST /api/v1/web-configs/partners/new
- GET /api/v1/web-configs/partners/all-admin
- PATCH /api/v1/web-configs/partners/toggle-active/:id
- DELETE /api/v1/web-configs/partners/delete/:id

---

## ğŸ” Authentication

### ğŸ”‘ Login

**POST /api/v1/auth/login** ğŸŒ _Public_

_Request Body:_

```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

_âœ… Response:_

```json
{
  "message": "Login successful",
  "admin": {
    "_id": "6832af7e0466922553a3a87d",
    "name": "Suyash Pandey",
    "email": "suyashpandey310@gmail.com",
    "role": "superAdmin",
    "created_at": "2025-05-25T05:49:50.130Z",
    "updated_at": "2025-07-07T23:08:55.948Z",
    "__v": 0,
    "last_login": "2025-07-07T23:08:55.947Z",
    "last_logout": "2025-07-07T23:06:40.741Z",
    "provider": "local"
  }
}
```

---

### ğŸ“§ Send OTP

**POST /api/v1/auth/send-otp** ğŸŒ _Public_

_Request Body:_

```json
{
  "email": "user@example.com"
}
```

_âœ… Success Response:_

```json
{ "message": "OTP sent to your email." }
```

_âŒ Error Response:_

```json
{ "message": "Email is required." }
```

---

### ğŸ”’ Forgot Password

**POST /api/v1/auth/forgot-password** ğŸŒ _Public_

_Request Body:_

```json
{
  "email": "user@example.com"
}
```

_âœ… Response:_

```json
{
  "message": "Password reset link sent to your email address"
}
```

---

### ğŸ”„ Reset Password

**POST /api/v1/auth/reset-password/:token** ğŸŒ _Public_

_Request Body:_

```json
{
  "new_password": "newpassword123"
}
```

_âœ… Response:_

```json
{
  "message": "Password reset successful"
}
```

---

### ğŸšª Logout

**POST /api/v1/auth/logout** ğŸ”’ _Requires Authentication_

_Headers:_ Cookie with token

_âœ… Response:_

```json
{ "message": "Logged out successfully" }
```

---

### ğŸ‘¤ Get Current User

**GET /api/v1/auth/me** ğŸ”’ _Requires Authentication_

_Headers:_ Cookie with token

_âœ… Response:_

```json
{
  "_id": "6832af7e0466922553a3a87d",
  "name": "Suyash Pandey",
  "email": "suyashpandey310@gmail.com",
  "role": "superAdmin",
  "created_at": "2025-05-25T05:49:50.130Z",
  "updated_at": "2025-07-07T23:08:55.948Z",
  "__v": 0,
  "last_login": "2025-07-07T23:08:55.947Z",
  "last_logout": "2025-07-07T23:06:40.741Z",
  "provider": "local"
}
```

---

### ğŸ›  Update Admin Profile

**PUT /api/v1/auth/me/update** ğŸ”’ _Requires Authentication_

_Request Body:_

```json
{
  "name": "Updated Name"
}
```

_âœ… Response:_

```json
{
  "message": "Profile updated successfully",
  "admin": {
    "_id": "6832af7e0466922553a3a87d",
    "name": "Updated Name",
    "email": "admin@example.com",
    "role": "editor",
    "provider": "local",
    "created_at": "2025-05-25T05:49:50.130Z",
    "updated_at": "2025-07-10T14:00:00.000Z"
  }
}
```

---

### ğŸ” Change Password

**PUT /api/v1/auth/change-password** ğŸ”’ _Requires Authentication_

_Request Body:_

```json
{
  "old_password": "oldpassword123",
  "new_password": "NewPassword@123"
}
```

_âœ… Response:_

```json
{
  "message": "Password changed successfully."
}
```

---

### âœ… Check Authenticated User

**GET /api/v1/auth/check** ğŸ”’ _Requires Authentication_

_âœ… Response:_

```json
{
  "_id": "6832af7e0466922553a3a87d",
  "name": "Admin Name",
  "email": "admin@example.com",
  "role": "editor",
  "provider": "local",
  "created_at": "2025-05-25T05:49:50.130Z",
  "updated_at": "2025-07-10T14:00:00.000Z"
}
```

---

### ğŸ§‘â€ğŸ’¼ Update Admin Role

**PUT /api/v1/auth/admins/update-role/\:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin)

_Note:_ This Route can only be accessed by **superAdmin** to update role of other admins

_Request Body:_

```json
{
  "role": "newsletterAdmin"
}
```

_âœ… Response:_

```json
{
  "message": "Role updated",
  "admin": {
    "_id": "6832af7e0466922553a3a87d",
    "name": "Admin Name",
    "email": "admin@example.com",
    "role": "newsletterAdmin"
  }
}
```

---

### ğŸ“‹ Get All Admins

**GET /api/v1/auth/admins/all** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin)

_âœ… Response:_

```json
{
  "message": "All admins fetched successfully",
  "admins": [
    {
      "_id": "6832af7e0466922553a3a87d",
      "name": "Admin Name",
      "email": "admin@example.com",
      "role": "superAdmin",
      "provider": "local",
      "created_at": "2025-05-25T05:49:50.130Z",
      "updated_at": "2025-07-10T14:00:00.000Z"
    }
  ]
}
```

## ğŸ“„ Content Management

> _Content Types:_ article | podcast | video | interview | webinar | news | insight | report | webcast | movements

### ğŸ“‹ Get All Content

**GET /api/v1/content/all** ğŸŒ _Public_ (Optional Authentication)

> _Note:_ Uses authOptionalMiddleware - authentication is optional but provides additional features if authenticated.

_Query Parameters:_
| Parameter | Default | Description |
|-----------|---------|-------------|
| page | 1 | Page number |
| limit | 10 | Items per page (max: 100) |
| content_type | optional | Filter by content type |
| sort | updated_at:desc | Sort format: field:asc\|desc |
| exec_role_id | optional | Filter by exec_role_id |
| theme_id | optional | Filter by theme_id |
| sub_theme_id | optional | Filter by sub_theme_id |
| industry_id | optional | Filter by industry_id |
| series_id | optional | Filter content of a particular series |
| search | optional | Search in title, slug, body, ai_summary |

_âœ… Response:_

```json
{
  "message": "Contents fetched successfully",
  "currentPage": 1,
  "totalPages": 5,
  "totalItems": 50,
  "contents": [
    {
      "_id": "6832df12f2164a53de4a898a",
      "title": "Leadership Insights from CXOs",
      "slug": "leadership-cxos-2025",
      "ai_summary": "Top executives share their leadership playbook for 2025.",
      "body": "In this episode, CXOs talk about balancing innovation and people...",
      "content_type": "podcast",
      "media_url": "https://youtu.be/iKLwzmjfcW4?feature=shared",
      "media_duration_sec": 1800,
      "banner_image_url": "https://res.cloudinary.com/dsqiyp8pf/image/upload/v1748164371/content_banners/en7whdok0hxqczxhh49i.png",
      "meta_description": "Podcast on executive leadership in modern business.",
      "meta_keywords": "leadership, CXO, podcast",
      "publish_date": "2025-05-25T10:13:19.323Z",
      "status": "published",
      "featured": false,
      "popular": true
      //...other contetn fields
    }
    // similar content objects
  ],
  "warning": "Limit capped to 100 items max per page." // optional
}
```

_âŒ Error Response:_

```json
{ "message": "Invalid content_type. Allowed values: article, podcast, ..." }
```

---

### ğŸš© Get Flagged Content

**GET /api/v1/content/flags/all** ğŸŒ _Public_

_âœ… Response:_

```json
{
  "message": "Flagged content fetched successfully",
  "contents": [
    /* array of flagged content */
  ]
}
```

### ğŸ“– Get Content by Slug

**GET /api/v1/content/slug/\:slug** ğŸŒ _Public_

> _Description:_ Fetch a single **published** content item using its unique slug (for clean, SEO-friendly URLs). Only `status: "published"` content is returned.

_Params:_

- `slug` (string) â€” Unique slug assigned to the content

_âœ… Response:_

```json
{
  "message": "Content fetched successfully",
  "content": {
    "_id": "6832df12f2164a53de4a898a",
    "title": "Leadership Insights from CXOs",
    "slug": "leadership-cxos-2025",
    "ai_summary": "Top executives share their leadership playbook for 2025.",
    "body": "In this episode, CXOs talk about balancing innovation and people...",
    "content_type": "podcast",
    "media_url": "https://youtu.be/iKLwzmjfcW4?feature=shared",
    "media_duration_sec": 1800,
    "banner_image_url": "https://res.cloudinary.com/dsqiyp8pf/image/upload/v1748164371/content_banners/en7whdok0hxqczxhh49i.png",
    "meta_description": "Podcast on executive leadership in modern business."
    //..other content fields
  }
}
```

_âŒ Error Response:_

```json
{ "message": "Content not found" }
```

---

### ğŸ“– Get Single Content (For admins)

**GET /api/v1/content/get/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_âœ… Response:_

```json
{
  "message": "Content fetched successfully",
  "content": {
    //complete content details
  }
}
```

---

### â• Create Content

**POST /api/v1/content/create** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_IMP:_

âŒDon't add `slug` as a key with some value in request. It will be generated automatically.

_Request Body:_

```json
// key-value pairs

  "title": yseudtrklbkb,
  "ai_summary": hello,
  "body": hahahaha,
  "content_type": insight,
  "banner_image": [FILE],  // <-IMPORTANT
  "meta_description": How renewable energy is reshaping the global power landscape.,
  "meta_keywords": renewable, energy, solar, wind, environment,
  "publish_date": 2025-06-01T09:00:00.000Z,
  "status": published,
  "featured": true,
  "popular": false,
  "hero": true,
  "theme_ids": ["66501f00a1234567890abcde"],
  "sub_theme_ids": ["66501f00a1234567890abcde"],
  "industry_ids": ["66502f11b1234567890bcdef"],
  "exec_role_ids": ["66503f22c1234567890cdef0"],
  "contributors": [
    { "contributor_id": "66503f22c1234567890cdef0", "role": "author" }
  ]
```

_âœ… Response:_

```json
{
  "message": "Content created successfully",
  "content": {
    //...complete content details
  }
}
```

---

### âœ Update Content

**PATCH /api/v1/content/update/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_ (Same as create, only fields to update)

```json
 //key-value pairs
  "title": "Doing something to display mock title..."
  "banner_image": [FILE]
  // only these fields gets updated

```

_âœ… Response:_

```json
{
  "message": "Content updated successfully",
  "content": {
    //..update content details
  }
}
```

---

### ğŸ—‘ Delete Content

**DELETE /api/v1/content/delete/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_âœ… Response:_

```json
{ "message": "Content deleted successfully" }
```

---

### ğŸš€ Publish Content

**PATCH /api/v1/content/publish/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_âœ… Response:_

```json
{
  "message": "Content published successfully",
  "content": {
    "id": "6832df12f2164a53de4a898a",
    "title": "Leadership Insights from CXOs",
    "status": "published",
    "publish_date": "2025-05-25T10:13:19.323Z"
  }
}
```

---

### ğŸ”„ Toggle Content Flags

**PATCH /api/v1/content/:id/toggle/:flag** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Available Flags:_ featured | popular | hero

_âœ… Response:_

```json
{
  "message": "Toggled featured for content id: 665f6e7b8c1b2a0012c3d4e5",
  "featured": true
}
```

---

### â• Add Contributor to Content

**POST /api/v1/content/add/:contentId/contributors** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Request Body:_

```json
{
  "contributor_id": "66503f22c1234567890cdef0",
  "role": "author"
}
```

_âœ… Response:_

```json
{
  "message": "Contributor added to content",
  "contributor": {
    //contributor details
  }
}
```

---

### âœ Update Contributor in Content

**PATCH /api/v1/content/update/:contentId/contributors/:contributorSubId** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Request Body:_ (fields to update for the contributor in this content only)

```json
{
  //key-value pairs

  "role": "Editor",
  "name": "Updated Name",
  "profile_image": [FILE], // <- IMPORTANT
  "company_logo": [FILE] // <- IMPORTANT
  "employment[job_position]" : "CEO",
  "employment[description]" : "Manage everything",
  "employment[company_name]" : "Google", //one way of passing nested data
  //can also use JSON.stringify(employment) and then pass it whole
}
```

_âœ… Response:_

```json
{
  "message": "Contributor updated in content",
  "contributor": {
    //updated contributor details
  }
}
```

---

### ğŸ—‘ Remove Contributor from Content

**DELETE /api/v1/content/delete/:contentId/contributors/:contributorSubId** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_âœ… Response:_

```json
{
  "message": "Contributor removed from content"
}
```

---

## ğŸ“§ Newsletter Management

### â• Add New Subscriber

**POST /api/v1/newsletter/subscribe** ğŸŒ _Public_

_Request Body:_

```json
{
  "email": "subscriber@example.com",
  "name": "Suyash Pandey"
}
```

_âœ… Response:_

```json
{
  "message": "Subscriber added successfully."
  //subscriber details
}
```

---

## ğŸ· Tag Management

### ğŸ¯ Themes

**GET /api/v1/tags/themes/all** ğŸŒ _Public_

_âœ… Response:_

```json
{
  "message": "All Theme fetched successfully",
  "items": [
    {
      "_id": "6832c3716ef334374315ef68",
      "name": "Leadership",
      "description": "Leadership topics",
      "created_at": "2025-05-25T07:14:57.140Z",
      "updated_at": "2025-05-25T17:05:35.568Z",
      "__v": 0
    }
  ]
}
```

---

**GET /api/v1/tags/themes/usage/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

> _Description:_ Checks how many content documents are associated with a specific theme before deletion.

_âœ… Response:_

```json
{
  "message": "Usage count fetched successfully.",
  "count": 25
}
```

---

**POST /api/v1/tags/themes/new** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_

```json
{
  "name": "Leadership",
  "description": "Leadership topics"
}
```

_âœ… Response:_

```json
{
  "message": "Theme created successfully",
  "item": {
    "_id": "6832c3716ef334374315ef68",
    "name": "Leadership",
    "description": "Leadership topics",
    "created_at": "2025-05-25T07:14:57.140Z",
    "updated_at": "2025-05-25T17:05:35.568Z",
    "__v": 0
  }
}
```

---

**PUT /api/v1/tags/themes/update/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_

```json
{
  "name": "Updated Leadership",
  "description": "Updated leadership topics"
}
```

_âœ… Response:_

```json
{
  "message": "Theme updated successfully",
  "item": {
    "_id": "6832c3716ef334374315ef68",
    "name": "Updated Leadership",
    "description": "Updated leadership topics",
    "created_at": "2025-05-25T07:14:57.140Z",
    "updated_at": "2025-05-25T17:05:35.568Z",
    "__v": 0
  }
}
```

---

**DELETE /api/v1/tags/themes/delete/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_âœ… Response:_

```json
{
  "message": "Theme deleted successfully"
}
```

---

### ğŸ§© SubThemes

**GET /api/v1/tags/sub-themes/all** ğŸŒ _Public_

_âœ… Response:_

```json
{
  "message": "All SubTheme fetched successfully",
  "items": [
    {
      "_id": "6832c3716ef334374315ef68",
      "name": "Leadership",
      "description": "Leadership topics",
      "created_at": "2025-05-25T07:14:57.140Z",
      "updated_at": "2025-05-25T17:05:35.568Z",
      "__v": 0
    }
  ]
}
```

---

**GET /api/v1/tags/sub-themes/usage/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

> _Description:_ Checks how many content documents are associated with a specific sub-theme before deletion.

_âœ… Response:_

```json
{
  "message": "Usage count fetched successfully.",
  "count": 12
}
```

---

**POST /api/v1/tags/sub-themes/new** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_

```json
{
  "name": "Leadership",
  "description": "Leadership topics"
}
```

_âœ… Response:_

```json
{
  "message": "SubTheme created successfully",
  "item": {
    "_id": "6832c3716ef334374315ef68",
    "name": "Leadership",
    "description": "Leadership topics",
    "created_at": "2025-05-25T07:14:57.140Z",
    "updated_at": "2025-05-25T17:05:35.568Z",
    "__v": 0
  }
}
```

---

**PUT /api/v1/tags/sub-themes/update/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_

```json
{
  "name": "Updated Leadership",
  "description": "Updated leadership topics"
}
```

_âœ… Response:_

```json
{
  "message": "SubTheme updated successfully",
  "item": {
    "_id": "6832c3716ef334374315ef68",
    "name": "Updated Leadership",
    "description": "Updated leadership topics",
    "created_at": "2025-05-25T07:14:57.140Z",
    "updated_at": "2025-05-25T17:05:35.568Z",
    "__v": 0
  }
}
```

---

**DELETE /api/v1/tags/sub-themes/delete/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_âœ… Response:_

```json
{
  "message": "SubTheme deleted successfully"
}
```

---

### ğŸ­ Industries

**GET /api/v1/tags/industries/all** ğŸŒ _Public_

_âœ… Response:_

```json
{
  "message": "Industries fetched successfully",
  "items": [
    {
      "_id": "6832c3716ef334374315ef68",
      "name": "Finance",
      "description": "Finance industry",
      "created_at": "2025-05-25T07:14:57.140Z",
      "updated_at": "2025-05-25T17:05:35.568Z",
      "__v": 0
    }
  ]
}
```

---

**GET /api/v1/tags/industries/usage/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

> _Description:_ Checks how many content documents are associated with an industry before deletion.

_âœ… Response:_

```json
{
  "message": "Usage count fetched successfully.",
  "count": 30
}
```

---

**POST /api/v1/tags/industries/new** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_

```json
{
  "name": "Finance",
  "description": "Finance industry"
}
```

---

**PUT /api/v1/tags/industries/update/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_

```json
{
  "name": "Updated Finance",
  "description": "Updated finance industry"
}
```

---

**DELETE /api/v1/tags/industries/delete/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_âœ… Response:_

```json
{
  "message": "Industry deleted successfully"
}
```

---

### ğŸ‘” Executive Roles

**GET /api/v1/tags/roles/all** ğŸŒ _Public_

_âœ… Response:_

```json
{
  "message": "Executive roles fetched successfully",
  "items": [
    {
      "_id": "6832c3716ef334374315ef68",
      "name": "CEO",
      "description": "Chief Executive Officer",
      "created_at": "2025-05-25T07:14:57.140Z",
      "updated_at": "2025-05-25T17:05:35.568Z",
      "__v": 0
    }
  ]
}
```

---

### ğŸ“Š Get Tag Usage Counts

**GET /api/v1/tags/roles/usage/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

> _Description:_ Checks how many content documents are associated with an executive role before deletion.

_âœ… Response:_

```json
{
  "message": "Usage count fetched successfully.",
  "count": 8
}
```

---

**POST /api/v1/tags/roles/new** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_

```json
{
  "name": "CEO",
  "description": "Chief Executive Officer"
}
```

---

**PUT /api/v1/tags/roles/update/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_Request Body:_

```json
{
  "name": "Updated CEO",
  "description": "Updated Chief Executive Officer"
}
```

---

**DELETE /api/v1/tags/roles/delete/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

_Headers:_ Cookie with token

_âœ… Response:_

```json
{
  "message": "Executive role deleted successfully"
}
```

---

## ğŸ‘¥ Contributor Management

> All endpoints require authentication and roles: `superAdmin` or `editor`

### ğŸ“‹ Get All Contributors

**GET /api/v1/contributors/all** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_

_âœ… Response:_

```json
{
  "message": "Contributors fetched successfully",
  "contributors": [
    {
      "_id": "68600824e941a93240537545",
      "name": "Hohohohoho",
      "email": "hohohoo.doe@example.com",
      "bio": "Tech speaker and open-source enthusiast.",
      "profile_image_url": "https://res.cloudinary.com/dsqiyp8pf/image/upload/v1751124004/contributors/pho4gjgdvtbdddji6ilp.webp",
      //other contributor details
      "__v": 0
    }
    //similar other docs
  ]
}
```

---

### ğŸ‘¤ Get Contributor by ID

**GET /api/v1/contributors/\:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_

_âœ… Response:_

```json
{
  "message": "Contributor fetched successfully",
  "contributor": {
    "_id": "68600824e941a93240537545",
    "name": "Hohohohoho",
    "email": "hohohoo.doe@example.com",
    "bio": "Tech speaker and open-source enthusiast.",
    "profile_image_url": "https://res.cloudinary.com/dsqiyp8pf/image/upload/v1751124004/contributors/pho4gjgdvtbdddji6ilp.webp",
    "linkedin_url": "https://www.linkedin.com/in/janedoe",
    "twitter_url": "https://twitter.com/janedoe"
    //other contributor details
  }
}
```

---

### â• Create Contributor

**POST /api/v1/contributors/new** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_

_Request Body:_

```json
{
  //key -value pairs
  "name": "Maria Garcia",
  "email": "maria.garcia@webcrafters.io",
  "bio": "Full-stack engineer and open-source enthusiast with over 8 years of experience in the tech industry. Co-founder of WebCrafters Inc.",
  "profile_image": "[FILE]", //<--IMPORTANT
  "company_logo": "[FILE]", //<--IMPORTANT //will go under current_emploment as company_logo_url
  "linkedin_url": "https://linkedin.com/in/mariagarciadev",
  "twitter_url": "https://twitter.com/mgarciatweets",
  "website_url": "https://mariagarcia.io",
  "current_employment[company_name]": "WebCrafters Inc.", //one way of passing nested data
  "current_employment[job_position]": "Lead Software Engineer",
  "current_employment[description]": "Leading the core product development team and mentoring junior developers."
  //another way using JSON.stringify(current_employment), where current_employment={} (contains the nsted fields)
}
```

_âœ… Response:_

```json
{
  "message": "Contributor created",
  "contributor": {
    //all contributor details
  }
}
```

---

### âœ Update Contributor

**PATCH /api/v1/contributors/update/\:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_

_Request Body:_ (only fields to update)

```json
{
  //key-value pairs
  "bio": "Senior Developer at Goldman Sachs",
  "profile_image": [FILE]
}
```

_âœ… Response:_

```json
{
  "message": "Contributor updated",
  "updated": {
    //contributor details
  }
}
```

---

### ğŸ—‘ Delete Contributor

**DELETE /api/v1/contributors/delete/\:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_

> Also deletes all employment records and the contributor's Cloudinary image.

_âœ… Response:_

```json
{ "message": "Contributor removed successfully" }
```

---

## ğŸ“¦ Series Management

> _Model: `Series`_

### ğŸ“‹ Get All Series

**GET /api/v1/series/all** ğŸŒ _Public_

_Query Parameters:_

- `sort`: Format `field:asc|desc` (default: `title:asc`)
- allowed_fields for sorting: `title`, `updated_at`, `created_at`

_âœ… Response:_

```json
{
  "message": "Series fetched successfully",
  "series": [
    {
      "_id": "series_id",
      "title": "Future Leaders Series",
      "slug": "future-leaders-series",
      "description": "Interviews with tomorrow's leaders",
      "company_name": "Google",
      "company_website_url": "https://google.com",
      "company_logo_url": "https://...",
      "frequency": "monthly",
      "created_at": "...",
      "updated_at": "..."
    }
  ]
}
```

---

### ğŸ“˜ Get Series by Slug

**GET /api/v1/series/slug/\:slug** ğŸŒ _Public_

_âœ… Response:_

```json
{
  "message": "Series fetched successfully",
  "series": {
    /* series object */
  }
}
```

---

### ğŸ“˜ Get Series by ID

**GET /api/v1/series/get/\:id** ğŸ”’ _Requires Authentication + Role_ (superAdmin, editor)

- Only for admins for editing page

```json
{
  "message": "Series fetched successfully",
  "series": {
    /* series object */
  }
}
```

---

### ğŸ“Š Get Series Usage Count

**GET /api/v1/series/usage/:id** ğŸ”’ğŸ‘‘ _Requires Authentication + Role_ (superAdmin, editor)

> _Description:_ Checks how many content documents are associated with a specific series. This is useful for showing a confirmation warning before deletion.

_âœ… Response:_

```json
{
  "message": "Usage count fetched successfully.",
  "count": 15
}
```

---

### â• Create Series

**POST /api/v1/series/create** ğŸ”’ _Requires Authentication + Role_ (superAdmin, editor)

- `Form-data/multipart` uploads
- Don't send `slug` (auto generated)

_Request Body:_

| Key                 | Value                           |
| ------------------- | ------------------------------- |
| title               | Tech Visionaries                |
| description         | Exploring emerging technologies |
| company_name        | Meta                            |
| company_website_url | https://meta.com                |
| frequency           | monthly                         |

---

### âœ Update Series

**PATCH /api/v1/series/update/\:id** ğŸ”’ _Requires Authentication + Role_ (superAdmin, editor)

_Request Body:_ Same fields as create (excluding slug and created_by)

- Key-value pair. But _ONLY FIELD YOU WANT TO UPDATE_

---

### ğŸ—‘ Delete Series

**DELETE /api/v1/series/delete/\:id** ğŸ”’ _Requires Authentication + Role_ (superAdmin, editor)

```json
{ "message": "Series deleted successfully" }
```

---

## ğŸ§  Web Configuration (Homepage)

### ğŸ”” Public Endpoints

#### ğŸ–¼ Event Banners

**GET /api/v1/web-configs/event-banners/all** ğŸŒ _Public_

```json
{
  "message": "Banners fetched successfully",
  "banners": [
    {
      /* banner object */
    }
  ]
}
```

#### ğŸ‘¨â€ğŸ’¼ Experts

**GET /api/v1/web-configs/experts/all** ğŸŒ _Public_

#### ğŸ¤ Partners

**GET /api/v1/web-configs/partners/all** ğŸŒ _Public_

---

### ğŸ” Admin Endpoints

#### ğŸ–¼ Event Banners

- **POST /event-banners/new** [_form-data_]

- **GET /event-banners/all-admin**

- **PATCH /event-banners/toggle-active/\:id** [_No data in request_, simple toggle with id]

- **DELETE /event-banners/delete/\:id**

_Request Body (POST):_

| Key                | Value               |
| ------------------ | ------------------- |
| caption            | New Year Summit     |
| link               | https://example.com |
| is_active          | true                |
| order              | 1                   |
| event_banner_image | [FILE]              |

---

#### ğŸ‘¨â€ğŸ’¼ Experts

- **POST /experts/new** [_form-data_]
- **PATCH /experts/update/\:id** [_form-data_]
- **GET /experts/all-admin**
- **PATCH /experts/toggle-active/\:id**
- **DELETE /experts/delete/\:id**

_Request Body (POST):_

| Key                  | Value           |
| -------------------- | --------------- |
| name                 | Alice Kumar     |
| job_position         | Chief Scientist |
| company_name         | ISRO            |
| is_active            | true            |
| order                | 0               |
| expert_profile_image | [FILE]          |

_Request Body (PATCH):_

- Similar to POST but only with field you want to update

---

#### ğŸ¤ Partner Compnies

- **POST /partners/new** [_form-data_]
- **GET /partners/all-admin**
- **PATCH /partners/toggle-active/\:id**
- **DELETE /partners/delete/\:id**

_Request Body (POST):_

| Key                        | Value                |
| -------------------------- | -------------------- |
| company_name               | McKinsey             |
| link                       | https://mckinsey.com |
| is_active                  | true                 |
| order                      | 2                    |
| partner_company_logo_image | [FILE]               |

_âœ… Response (Generic):_

```json
{ "message": "<Entity> added/updated/deleted successfully" }
```

---

## âš  Error Responses

All endpoints return errors in the following format:

```json
{ "message": "Error message here" }
```

---

## ğŸ”’ Authentication & Authorization

### Authentication Types

| Icon | Type                             | Description                              |
| ---- | -------------------------------- | ---------------------------------------- |
| ğŸŒ   | _Public_                         | No authentication required               |
| ğŸ”’   | _Authentication Required_        | Valid JWT token in cookie required       |
| ğŸ”’ğŸ‘‘ | _Authentication + Role Required_ | Valid JWT token + specific role required |

### Authentication Method

Most endpoints require a valid JWT token stored in an HttpOnly cookie named token.

### Role-Based Access Control

| Role              | Permissions                                               |
| ----------------- | --------------------------------------------------------- |
| _superAdmin_      | Full access to all endpoints                              |
| _editor_          | Content creation, editing, publishing, and tag management |
| _newsletterAdmin_ | Newsletter management and subscriber operations           |
| _eventAdmin_      | Event management (if implemented)                         |
| _user_            | Limited read access to public endpoints                   |

### Middleware Chain

Routes use middleware in this order:

1. _authMiddleware_ - Validates JWT token and populates req.user
2. _authOptionalMiddleware_ - Optional authentication for public endpoints with enhanced features
3. _roleMiddleware(roles)_ - Checks if authenticated user has required role
4. _uploadMiddleware_ - Perform checks on images to be uploaded

---

## ğŸ“ Important Notes

- THE _POST/PUT/PATCH_ endpoints `without` any upload middleware (no image involved) expect Content-Type: application/json
- All _POST/PUT/PATCH_ endpoints `with` upload middleware(image may involve) expect Content-Type: form-data/multipart
- All endpoints return _JSON_.
- Maximum limit for pagination is _100 items per page_
- Base64 images are _NOT_ supported for content banner uploads
- OAuth integration available for Google and LinkedIn
- JWT tokens are stored in HttpOnly cookies for security
- Rate limiting may apply to prevent abuse

---

## ğŸ›  Technical Specifications

- _Framework:_ Express.js
- _Authentication:_ JWT with HttpOnly cookies
- _Authorization:_ Role-based access control
- _File Upload:_ Multer direct file upload
- _Database:_ MongoDB
- _Image Storage:_ Cloudinary integration
- _OAuth Providers:_ Google, LinkedIn

---

## ğŸ“š Usage Examples

### Authentication Flow

```javascript
// Register new user
fetch("/api/v1/auth/send-otp", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ email: "user@example.com" }),
});

// Register with OTP
fetch("/api/v1/auth/register", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    name: "John Doe",
    email: "user@example.com",
    password: "password123",
    otp: "123456",
    role: "editor",
  }),
});

// Login
fetch("/api/v1/auth/login", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    email: "user@example.com",
    password: "password123",
  }),
});
```

### Content Management

```javascript
// Create new article
fetch("/api/v1/content/create", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  credentials: "include", // Include cookies
  body: JSON.stringify({
    title: "AI in Executive Leadership",
    slug: "ai-executive-leadership-2025",
    content_type: "article",
    body: "Article content here...",
    status: "published",
    featured: true,
  }),
});

// Get paginated content
fetch(
  "/api/v1/content/all?page=1&limit=20&content_type=article&search=leadership"
);

// Toggle content flag
fetch("/api/v1/content/123/toggle/featured", {
  method: "PATCH",
  credentials: "include",
});
```

### Newsletter Management

```javascript
// Add subscriber
fetch("/api/v1/newsletter/subscriber", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ email: "subscriber@example.com" }),
});

```

---

## ğŸš¦ Status Codes

| Code | Status                | Description                   |
| ---- | --------------------- | ----------------------------- |
| 200  | OK                    | Request successful            |
| 201  | Created               | Resource created successfully |
| 400  | Bad Request           | Invalid request data          |
| 401  | Unauthorized          | Authentication required       |
| 403  | Forbidden             | Insufficient permissions      |
| 404  | Not Found             | Resource not found            |
| 409  | Conflict              | Resource already exists       |
| 422  | Unprocessable Entity  | Validation error              |
| 500  | Internal Server Error | Server error                  |

---

## ğŸ›¡ Security Features

- **JWT Authentication** with HttpOnly cookies
- **Role-based Authorization** (RBAC)
- **Password Hashing** with bcrypt
- **Input Validation** and sanitization
- **CORS Protection** configured

---

### Content Flags

- **Featured** ğŸŒŸ - Highlighted content on homepage
- **Popular** ğŸ”¥ - Trending/popular content section
- **Hero** ğŸ¯ - Main banner/hero section content

---

## ğŸ“ˆ API Response Patterns

### Success Response Format

```json
{
  "message": "Operation successful",
  "data": {
    /* response data */
  },
  "meta": {
    /* pagination, counts, etc */
  }
}
```

### Error Response Format

```json
{
  "message": "Error description",
  "error": "ERROR_CODE",
  "details": {
    /* additional error details */
  }
}
```

### Pagination Response

```json
{
  "message": "Data fetched successfully",
  "currentPage": 1,
  "totalPages": 10,
  "totalItems": 100,
  "contents": [
    /* array of items */
  ]
}
```

---

## ğŸ“ Support & Contact

For API support and documentation updates, please contact [Suyash Pandey](mailto:suyash@exec-stream.com).

**API Version:** v1  
**Last Updated:** July 27, 2025  
**Documentation Status:** âœ… Complete
